(this["webpackJsonpcar-app"]=this["webpackJsonpcar-app"]||[]).push([[0],{153:function(e,t,a){e.exports=a(299)},208:function(e,t){},298:function(e,t,a){},299:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(33),s=a.n(i),o=a(20),c=a(8),l=a(9),u=a(11),p=a(10),d=a(15),m=a(24),h=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={expand:!1},e.toggleExpand=function(){e.setState({expand:!e.state.expand})},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",null,r.a.createElement("img",{className:"user-preview",src:this.props.user.imgUrl,alt:this.props.user.username+"img",onClick:this.toggleExpand}),r.a.createElement("div",{className:"user-preview-expand flex column justify-around ".concat(this.state.expand?"open":"")},r.a.createElement(m.Link,{to:"/user/".concat(this.props.user._id)},"My Trips"),r.a.createElement("button",{onClick:function(){e.props.logout(),e.props.openMainNavbar()}},"Logout"))))}}]),a}(n.Component),f=a(4),v=a.n(f),g=a(7),y=a(142),b=a.n(y).a.create({withCredentials:!0}),E=function(e,t){return j(e,"GET",t)},w=function(e,t){return j(e,"POST",t)},O=function(e,t){return j(e,"PUT",t)},D=function(e,t){return j(e,"DELETE",t)};function j(e){return k.apply(this,arguments)}function k(){return(k=Object(g.a)(v.a.mark((function e(t){var a,n,r,i=arguments;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.length>1&&void 0!==i[1]?i[1]:"get",n=i.length>2&&void 0!==i[2]?i[2]:null,e.prev=2,e.next=5,b({url:"".concat("/api/").concat(t),method:a,data:n});case 5:return r=e.sent,e.abrupt("return",r.data);case 9:throw e.prev=9,e.t0=e.catch(2),console.log("Had Issues ".concat(a,"ing to the backend, endpoint: ").concat(t,", with data: ").concat(n)),console.dir(e.t0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}var x={query:function(){return T.apply(this,arguments)},getById:function(e){return N.apply(this,arguments)},remove:function(e){return D("trip/".concat(e))},save:function(e){return e._id?O("trip/".concat(e._id),e):w("trip",e)}};function T(){return(T=Object(g.a)(v.a.mark((function e(){var t,a,n=arguments;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{name:""},a="?search=".concat(t.name),e.abrupt("return",E("trip".concat(a)));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return(N=Object(g.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E("trip/".concat(t),t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var S=a(143),M=a.n(S),C=function(){var e;return{setup:function(){e=M()("")},on:function(t,a){e.on(t,a)},off:function(t,a){e.off(t,a)},emit:function(t,a){e.emit(t,a)},terminate:function(){e=null}}}();function I(e,t){return function(){var a=Object(g.a)(v.a.mark((function a(n){var r;return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,r={},!t){a.next=10;break}return n({type:"SET_LOADER"}),a.next=6,new Promise((function(t,a){setTimeout(Object(g.a)(v.a.mark((function a(){var n;return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,x.getById(e);case 2:n=a.sent,t(n);case 4:case"end":return a.stop()}}),a)}))),3500)}));case 6:r=a.sent,n({type:"SET_TRIP",trip:r}),a.next=14;break;case 10:return a.next=12,x.getById(e);case 12:r=a.sent,n({type:"SET_TRIP",trip:r});case 14:return a.abrupt("return",r);case 17:a.prev=17,a.t0=a.catch(0),console.log(a.t0);case 20:return a.prev=20,n({type:"CLOSE_LOADER"}),a.finish(20);case 23:case"end":return a.stop()}}),a,null,[[0,17,20,23]])})));return function(e){return a.apply(this,arguments)}}()}function A(e){return function(){var t=Object(g.a)(v.a.mark((function t(a){var n;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.query(e);case 2:n=t.sent,a({type:"SET_TRIPS",trips:n});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}function R(e){return function(){var t=Object(g.a)(v.a.mark((function t(a){var n;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,x.save(e);case 3:return n=t.sent,a({type:"EDIT_TRIP",trip:n}),t.abrupt("return",n);case 8:t.prev=8,t.t0=t.catch(0);case 10:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()}function _(e,t){return function(a){a({type:"SET_MODAL",cmp:e,props:t})}}function L(){return function(e){e({type:"CLOSE_MODAL"})}}var H={login:function(e){return B.apply(this,arguments)},logout:function(){return W.apply(this,arguments)},signup:function(e){return U.apply(this,arguments)},getUsers:function(){return E("user")},getById:function(e){return E("user/".concat(e))},remove:function(e){return D("user/".concat(e))},update:function(e){return O("user/".concat(e._id),e)}};function B(){return(B=Object(g.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("auth/login",t);case 2:if(!(a=e.sent)){e.next=5;break}return e.abrupt("return",P(a));case 5:return e.abrupt("return",Promise.reject("user not found"+t));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(){return(U=Object(g.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("auth/signup",t);case 2:return a=e.sent,e.abrupt("return",P(a));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(){return(W=Object(g.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("auth/logout");case 2:sessionStorage.clear();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){return sessionStorage.setItem("user",JSON.stringify(e)),e}window.userService=H;var F=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={navBar:"",isNavbarOpen:!1},e.backgroundChanged=function(){var t=e.props.location.pathname.match("/"),a=t&&e.props.location.pathname===t[0];window.pageYOffset>=80||!a?e.setState({navBar:!0}):e.setState({navBar:!1})},e.openMainNavbar=function(){e.setState({isNavbarOpen:!e.state.isNavbarOpen})},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.location.pathname.match("/");e&&this.props.location.pathname===e[0]||this.backgroundChanged(),window.addEventListener("scroll",this.backgroundChanged)}},{key:"componentDidUpdate",value:function(e,t){this.props.location.pathname!==e.location.pathname&&(this.backgroundChanged(),"/"===this.props.location.pathname&&this.props.resetTrip())}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.backgroundChanged)}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"main-navbar flex justify-between align-center full  "+(this.state.navBar?"navBar-background":"")},r.a.createElement(m.Link,{to:"/",onClick:this.openMainNavbar}," ",r.a.createElement("h1",{className:"logo"},"Trolly")),r.a.createElement("div",{className:"flex justify-between main-navbar-links ".concat(this.state.isNavbarOpen?"mainbar-open":"")},r.a.createElement(m.Link,{to:"/trip",onClick:this.openMainNavbar},"Trips"),r.a.createElement(m.NavLink,{to:"/about",onClick:this.openMainNavbar},"About"),this.props.usersData.loggedInUser?r.a.createElement(h,{openMainNavbar:this.openMainNavbar,logout:this.props.logout,user:this.props.usersData.loggedInUser}):r.a.createElement("div",{onClick:function(){return e.props.showModal("login")}},"Login")),r.a.createElement("button",{onClick:this.openMainNavbar}," \u2630")),r.a.createElement("div",{className:"navbar-screen ".concat(this.state.isNavbarOpen?"screen-open":""),onClick:this.openMainNavbar}))}}]),a}(n.Component),Y={showModal:_,logout:function(){return function(){var e=Object(g.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H.logout();case 2:t({type:"SET_USER",user:null});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},resetTrip:function(){return function(e){e({type:"SET_TRIP",trip:null})}}},J=Object(d.b)((function(e){return{usersData:e.userReducer}}),Y)(Object(o.o)(F));function Q(){return r.a.createElement("div",null,"About")}var q=a(16),z=a(3),V=a(35),G={makeId:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<e;n++)t+=a.charAt(Math.floor(Math.random()*a.length));return t},calculateDays:function(e,t){t=new Date(t),e=new Date(e);var a=t.getTime()-e.getTime();return Math.ceil(a/999/60/60/24)},createMat:function(e,t){for(var a=[],n=0;n<t;n++){a[n]=[];for(var r=0;r<e;r++)a[n][r]={pos:{i:n,j:r}},0===r&&(a[n][r]=Object(z.a)(Object(z.a)({},a[n][r]),{},{col:0}))}return a},getDateDay:function(e){return new Date(e).getDate()},getWeekDay:function(e){var t=new Date(e);return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][t.getDay()]},getTimeDayStr:function(e){var t=new Date(e),a=K(t.getHours()),n=K(t.getMinutes());return"".concat(a,":").concat(n)},getRandomPic:function(){var e=X(0,$.length-1);return $[e]},getRandomInt:X,getIsoTime:function(e){var t=new Date(e);return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t.toISOString().slice(0,16)},calculateDates:function(e,t,a){var n=new Date(e),r=[{day:n,td:{start:0}}];for(;n.getDate()!==new Date(t).getDate();)n=new Date(n.getTime()+864e5),r.push({day:n,td:""}),a.forEach((function(e){e.start.getDate()===n.getDate()&&e.start.getMonth()===n.getMonth()?r[r.length-1].td=Object(z.a)(Object(z.a)({},r[r.length-1].td),{},{start:e.idx}):e.start<n&&n.setHours(12)<e.end.setHours(11)?r[r.length-1].td=Object(z.a)(Object(z.a)({},r[r.length-1].td),{},{full:e.idx}):e.end.getDate()===n.getDate()&&e.end.getMonth()===n.getMonth()&&(r[r.length-1].td=Object(z.a)(Object(z.a)({},r[r.length-1].td),{},{end:e.idx}))}));return r},getRandomLatLng:function(){var e=[{lat:-23.5475,lng:-46.6361},{lat:13.751330328,lng:100.489664708},{lat:25.105497,lng:121.597366},{lat:21.028511,lng:105.804817},{lat:39.916668,lng:116.383331},{lat:-16.5,lng:-68.15},{lat:27.700769,lng:85.30014},{lat:14.599512,lng:120.984222},{lat:1.29027,lng:103.851959},{lat:6.927079,lng:79.861244},{lat:28.6448,lng:77.216721}];return e[X(0,e.length-1)]},setToHourMinuets:function(e,t,a){var n=new Date(e);return n.setHours(t,a),n.getTime()}};function K(e){return 1===(e+"").length?"0"+e:e}function X(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1)+e)}var $=["https://images.unsplash.com/photo-1484804959297-65e7c19d7c9f?ixlib=rb-1.2.1","https://images.unsplash.com/photo-1550399504-8953e1a6ac87?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1473496169904-658ba7c44d8a?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=1080&fit=max&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1527004013197-933c4bb611b3?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1480497490787-505ec076689f?ixlib=rb-1.2.1","https://images.unsplash.com/photo-1475066392170-59d55d96fe51?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1477959858617-67f85cf4f1df?ixlib=rb-1.2.1","https://images.unsplash.com/photo-1507272931001-fc06c17e4f43?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1559128010-7c1ad6e1b6a5?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1545579133-99bb5ab189bd?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1519451241324-20b4ea2c4220?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1528181304800-259b08848526?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1524492412937-b28074a5d7da?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1516483638261-f4dbaf036963?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1523906834658-6e24ef2386f9?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1517792844039-e52afb564132?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1499678329028-101435549a4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1535063406830-27dfae54262a?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1554357475-accb8a88a330?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1559628233-100c798642d4?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1527095655060-4026c4af2b25?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1583702993462-43615c05ceee?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1505662695181-d4b60363d2a3?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1455459182396-ae46100617cb?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/photo-1512453979798-5ea266f8880c?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/flagged/photo-1559717865-a99cac1c95d8?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0","https://images.unsplash.com/flagged/photo-1559717201-fbb671ff56b7?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjE2NjY2NH0"],Z=a(48),ee=a.n(Z);a(94);function te(e){var t=this;return function(a){setTimeout((function(){t.closeMsg()}),3e3),a({type:"SET_MSG",msg:e})}}function ae(){return function(e){e({type:"CLOSE_MSG"})}}var ne=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.msg,a=e.type;return r.a.createElement(r.a.Fragment,null,"input"===a&&r.a.createElement("div",{className:this.props.isShown?"":"hide"},r.a.createElement("small",{className:"error-msg"},r.a.createElement("i",{className:"fas fa-exclamation-circle"}),t)),"invalid-move"===a&&r.a.createElement("div",{className:this.props.isShown?"":"hide"},r.a.createElement("p",{className:"invalid-move"},r.a.createElement("i",{className:"fas fa-exclamation-triangle"}),t)))}}]),a}(n.Component),re={showMsg:te,closeMsg:ae},ie=Object(d.b)((function(e){return{msg:e.msgReducer.msg,isShown:e.msgReducer.isShown,type:e.msgReducer.type}}),re)(ne),se=a(46),oe=a.n(se),ce=(n.Component,function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={tripName:"",currTrip:{name:"",location:{lat:null,lng:null},startDate:"",endDate:""},destinations:""},e.onSetDestinations=function(t){t.preventDefault();var a=e.state.currTrip;a.name=a.name.toLowerCase(),e.state.currTrip.startDate||e.state.currTrip.endDate||(a.startDate=Date.now(),a.endDate=Date.now()+864e5),a.id=G.makeId(),e.setState({destinations:[].concat(Object(V.a)(e.state.destinations),[a]),currTrip:{name:"",location:{lat:null,lng:null},startDate:"",endDate:""}})},e.onSaveDestination=function(){var t=Object(g.a)(v.a.mark((function t(a){var n,r;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),e.state.destinations.length){t.next=4;break}return e.props.showMsg({type:"input",msg:"At least one destination must be added"}),t.abrupt("return");case 4:return n={tripName:e.state.tripName,imgUrl:G.getRandomPic(),activities:[],destinations:e.state.destinations},e.props.loggedInUser?n.members=[{id:e.props.loggedInUser._id,username:e.props.loggedInUser.username,imgUrl:e.props.loggedInUser.imgUrl}]:n.members=[],t.next=8,e.props.addTrip(n);case 8:r=t.sent,e.props.history.push("/trip/".concat(r._id,"/tripRoute"));case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleAddress=function(t){e.setState({currTrip:Object(z.a)(Object(z.a)({},e.state.currTrip),{},{name:t})})},e.handleSelect=function(){var t=Object(g.a)(v.a.mark((function t(a){var n,r;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(se.geocodeByAddress)(a);case 2:return n=t.sent,t.next=5,Object(se.getLatLng)(n[0]);case 5:r=t.sent,e.setState({currTrip:Object(z.a)(Object(z.a)({},e.state.currTrip),{},{location:r,name:a})});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleInput=function(t,a){var n,r;t.target&&"tripName"===t.target.name?e.setState(Object(z.a)(Object(z.a)({},e.state),{},{tripName:t.target.value})):(t.target?(n=t.target.value,r=t.target.name):(n=new Date(t).getTime(),r=a),e.setState(Object(z.a)(Object(z.a)({},e.state),{},{currTrip:Object(z.a)(Object(z.a)({},e.state.currTrip),{},Object(q.a)({},r,n))})))},e.formatDate=function(e){return"".concat(new Date(e).getDate(),"/").concat(new Date(e).getMonth()+1,"/").concat(new Date(e).getFullYear())},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.state.destinations.length&&this.state.destinations[this.state.destinations.length-1].endDate||Date.now();return r.a.createElement("div",{className:"flex add-destination-form-wraper"},r.a.createElement("form",{className:"flex column add-destination-form",onSubmit:this.onSetDestinations},r.a.createElement("div",{className:"flex column"},r.a.createElement("label",{htmlFor:"add-dest-name"},"Add name to your trip:"),r.a.createElement("input",{className:"styled-input",type:"text",name:"tripName",placeholder:"Enter Trip Name",id:"add-dest-name",value:this.state.tripName,required:!0,onChange:this.handleInput})),r.a.createElement("div",{className:"flex column"},r.a.createElement("label",{htmlFor:"add-dest-city"},"Add Destination:"),r.a.createElement("input",{className:"styled-input",type:"text",name:"name",placeholder:"Enter City Name",id:"add-dest-city",value:this.state.currTrip.name,required:!0,onChange:this.handleInput})),r.a.createElement("div",{className:"flex"},r.a.createElement("div",{className:"flex column"},r.a.createElement("label",{htmlFor:"startdate-dest-input"},"Start At"),r.a.createElement(ee.a,{minDate:t,id:"startdate-dest-input",name:"startDate",className:"styled-input",required:!0,selected:this.state.destinations.length?t:Date.now(),onChange:function(t){e.handleInput(t,"startDate")}})),r.a.createElement("div",{className:"flex column"},r.a.createElement("label",{htmlFor:"enddate-dest-input"},"End At"),r.a.createElement(ee.a,{minDate:this.state.currTrip.startDate||Date.now(),id:"enddate-dest-input",name:"endDate",className:"styled-input",required:!0,selected:this.state.currTrip.endDate||Date.now(),onChange:function(t){e.handleInput(t,"endDate")}}))),r.a.createElement(ie,null),r.a.createElement("button",{className:"styled-button",onSubmit:this.onSetDestinations},"Add destination"),this.state.destinations.length?r.a.createElement("ol",{className:"trip-list-add-form flex column"},this.state.destinations.map((function(t){return r.a.createElement("li",{key:G.makeId(),className:"flex justify-between"},r.a.createElement("p",null,t.name),r.a.createElement("div",{className:"flex"},r.a.createElement("p",null,e.formatDate(t.startDate))," -",r.a.createElement("p",null,e.formatDate(t.endDate))))}))):"",r.a.createElement("button",{className:"styled-button",onClick:this.onSaveDestination},"Ready To Plan!")),r.a.createElement("div",{className:"add-dest-img-wraper"},r.a.createElement("img",{src:"https://images.unsplash.com/photo-1484804959297-65e7c19d7c9f?ixlib=rb-1.2.1",alt:""})))}}]),a}(n.Component)),le={addTrip:R,showMsg:te,closeMsg:ae},ue=Object(d.b)((function(e){return{loggedInUser:e.userReducer.loggedInUser}}),le)(Object(o.o)(ce)),pe=a(316),de=a(313),me=a(315),he=a(306),fe=a(307),ve=a(308),ge=a(309),ye=a(310),be=a(311),Ee=a(312),we=(a(277),a(278),a(146)),Oe={add:function(e){return je.apply(this,arguments)},query:function(e){return De.apply(this,arguments)},remove:function(e){return D("review/".concat(e))}};function De(){return(De=Object(g.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&(a="?tripId=".concat(t.tripId)),e.abrupt("return",E("review".concat(a)));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function je(){return(je=Object(g.a)(v.a.mark((function e(t){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.createdAt=Date.now(),e.next=3,w("review",t);case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ke={loadReviews:function(e){return function(){var t=Object(g.a)(v.a.mark((function t(a){var n;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Oe.query(e);case 3:return n=t.sent,a({type:"SET_REVIEWS",reviews:n}),t.abrupt("return",n);case 8:t.prev=8,t.t0=t.catch(0),console.log("ReviewActions: err in loadReviews",t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},addReview:function(e){return xe.apply(this,arguments)}};function xe(){return(xe=Object(g.a)(v.a.mark((function e(t){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Oe.add(t);case 2:return e.abrupt("return",function(){var e=Object(g.a)(v.a.mark((function e(a){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Oe.add(t);case 3:n=e.sent,a({type:"REVIEW_ADD",review:n}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("ReviewActions: err in addReview",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Te=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleClick=function(){e.props.history.push("/trip/".concat(e.props.trip._id,"/triproute"))},e.getTripPrice=function(e){return e.reduce((function(e,t){return e+=t.price.amount}),0)},e.getReviewsAvg=function(){try{var t=e.state.reviews.reduce((function(t,a){return e.state.reviews.length?t+=+a.rating:t=0,t}),0);return t?(t/e.state.reviews.length).toFixed(1):0}catch(a){}},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(g.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.loadReviews({tripId:this.props.trip._id});case 2:(t=e.sent)||(Object(we.a)("reviews"),t=[]),this.setState({reviews:t});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.trip,a=e.addClass;if(!t)return r.a.createElement("p",null,"Loading Trip . . .");var n=this.getTripPrice(t.activities),i=G.calculateDays(t.destinations[0].startDate,t.destinations[t.destinations.length-1].endDate),s=this.props.style?this.props.style:"",o=this.getReviewsAvg();return r.a.createElement("div",{style:{pointerEvents:s.pointerEvents?s.pointerEvents:"inherit"},onClick:this.handleClick,className:"trip-preview flex column "+(a||"")},r.a.createElement("div",{className:"img-wraper"},r.a.createElement("img",{src:t.imgUrl,alt:""})),r.a.createElement("div",{className:"trip-preview-details"},r.a.createElement("h3",null,t.tripName),r.a.createElement("div",{className:"flex details-container"},t.createdBy&&r.a.createElement("div",{className:"flex align-center column img-container"},r.a.createElement("img",{className:"user-img",src:t.createdBy.imgUrl,alt:"user-img"}),r.a.createElement("p",null," ",t.createdBy.username)),r.a.createElement("div",{className:"flex justify-between column"},r.a.createElement("p",null,r.a.createElement("i",{className:"fas fa-hourglass-half"}),i," days"),r.a.createElement("p",null,"Est Price: ",r.a.createElement("i",{className:"fas fa-dollar-sign"}),n),r.a.createElement("div",{className:"flex rating-star"},r.a.createElement("img",{src:"https://res.cloudinary.com/idanrozen/image/upload/v1600689776/450716_preview_uyyiz1.png",alt:""}),r.a.createElement("div",{className:"flex justify-between"},o?r.a.createElement("span",null,o," ",r.a.createElement("span",null,"(",this.state.reviews.length," reviews) ")):"(0)")),r.a.createElement("p",null,"Trollied by Roi and ".concat(G.getRandomInt(50,220)," others"))))))}}]),a}(n.Component),Ne={loadReviews:ke.loadReviews},Se=Object(d.b)((function(e){return{reviews:e.reviewReducer.reviews}}),Ne)(Object(o.o)(Te)),Me=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(g.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.trips.length){e.next=3;break}return e.next=3,this.props.loadTrips();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.trips,a=e.addClass,n=e.showModal;return t.length?r.a.createElement("div",{className:"trip-list trips-container "+(a||"")},t.length?t.map((function(e,t){return r.a.createElement(Se,{key:e._id,trip:e,showModal:n,addClass:a,img:G.getRandomPic()})})):r.a.createElement(Se,{key:t._id,trip:t,addClass:a,img:G.getRandomPic()})):r.a.createElement("p",null,"Loading Trips . . . ")}}]),a}(n.Component),Ce={loadTrips:A},Ie=Object(d.b)((function(e){return{trips:e.tripReducer.trips}}),Ce)(Me);me.a.use([he.a,fe.a,ve.a,ge.a,ye.a,be.a,Ee.a]);function Ae(e){var t=e.trips;return r.a.createElement(pe.a,{effect:"coverflow",slidesPerView:"auto",navigation:!0,centeredSlides:!0,delay:2500,coverflowEffect:{rotate:30,depth:200},pagination:{clickable:!0}},t.map((function(e,t){return r.a.createElement(de.a,{key:G.makeId()},r.a.createElement(Se,{trip:e,key:e._id,addClass:"slider",img:G.getRandomPic()}))})))}function Re(){return r.a.createElement("div",{className:"flex column align-center user-flow",id:"userFlow"},r.a.createElement("div",{className:"flex align-center"},r.a.createElement("div",null,r.a.createElement("p",{className:"flow-headline"},"Choose a trip"),r.a.createElement("p",{className:"flow-content"},"Choose from one of our amazing planned trips")),r.a.createElement("img",{src:"https://res.cloudinary.com/roidinary/image/upload/v1600869772/undraw_traveling_t8y2_xnd0ne.svg",alt:"choose-travel"})),r.a.createElement("div",{className:"flex align-center"},r.a.createElement("img",{src:"https://res.cloudinary.com/roidinary/image/upload/v1600869761/undraw_travel_plans_li01_k6igg6.svg",alt:""}),r.a.createElement("div",{className:"flow-text"},r.a.createElement("p",{className:"flow-headline"},"Personalize it"),r.a.createElement("p",{className:"flow-content"},"Personalize ",r.a.createElement("span",{style:{fontWeight:"bold"}},"destinations "),"on Route and ",r.a.createElement("span",{style:{fontWeight:"bold"}},"activities "),"on Assembly "))),r.a.createElement("div",{className:"flex align-center"},r.a.createElement("div",null,r.a.createElement("p",{className:"flow-headline"},"Add your friends"),r.a.createElement("p",{className:"flow-content"},"invite friends to plan together on the same document")),r.a.createElement("img",{src:"https://res.cloudinary.com/roidinary/image/upload/v1600870015/undraw_social_friends_nsbv_c9ovrw.svg",alt:""})))}var _e=a(84),Le=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={trips:""},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(g.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.loadTrips();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.props.trips[0]?r.a.createElement("div",{className:"home-page  main-container "},r.a.createElement("div",{className:"home-page-hero full"},r.a.createElement("div",{className:"description-section"},r.a.createElement("h3",null,"Explore planned trips of professional travelers"),r.a.createElement("h3",null,"and personalize them"),r.a.createElement(_e.HashLink,{smooth:!0,to:"#userFlow",scroll:function(e){return e.scrollIntoView({behavior:"smooth",block:"center"})}},r.a.createElement("button",{className:"styled-button"}," Get Started")))),r.a.createElement("div",{className:"main-home-page full"},r.a.createElement("div",{className:"flow-container"},r.a.createElement(Re,{id:"userFlow"}),r.a.createElement(_e.HashLink,{smooth:!0,to:"#top-rated-trips",scroll:function(e){return e.scrollIntoView({behavior:"smooth",block:"nearest"})}},r.a.createElement("button",{className:"styled-button"}," Let's Trolly!"))),r.a.createElement("div",{className:"slideShow-area",id:"top-rated-trips"},r.a.createElement("div",{id:"top-rated-trips"}),r.a.createElement("h2",{className:""},"Top rated planned trips"),r.a.createElement("section",{className:"slideShow"},r.a.createElement(Ae,{trips:this.props.trips.slice(0,4)}),r.a.createElement(_e.HashLink,{to:"/trip"},r.a.createElement("button",{className:"styled-button to-trip-list"}," Show me more")))),r.a.createElement(ue,null))):r.a.createElement("p",null," ")}}]),a}(n.Component),He={loadTrips:A},Be=Object(d.b)((function(e){return{trips:e.tripReducer.trips}}),He)(Le),Ue=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=(e.onsetFilter,e.mostOccDests);return r.a.createElement("div",{className:"trip-filter flex",style:this.props.style},r.a.createElement("img",{src:"https://res.cloudinary.com/idanrozen/image/upload/v1601236322/search_ejr7qx.png",alt:""}),r.a.createElement("input",{autoComplete:"off",placeholder:"Search destination",className:"styled-input",name:"name",onChange:this.props.handleInput,list:"dest-filter"}),r.a.createElement("datalist",{onChange:this.props.handleInput,id:"dest-filter"},t.map((function(e){return r.a.createElement("option",{key:G.makeId(),value:"".concat(e)})}))))}}]),a}(n.Component),We=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={filterBy:{name:""}},e.getMostOccDests=function(){var t=e.props.trips,a=[];t.forEach((function(e){a=a.concat(e.destinations)}));var n=a.reduce((function(e,t){return e[t.name]=e[t.name]?e[t.name]+1:1,e}),{}),r=Object.entries(n);return r.sort((function(e,t){return t[1]-e[1]})),r.slice(0,5).map((function(e){return e[0][0].toLocaleUpperCase()+e[0].substring(1)}))},e.handleInput=function(t){var a=t.target,n=a.name,r=a.value;e.setState({filterBy:Object(z.a)(Object(z.a)({},e.state.filterBy),{},Object(q.a)({},n,r))},(function(){e.props.loadTrips(e.state.filterBy)}))},e.getTripsForDisplay=function(){return e.props.trips.filter((function(t){return t.destinations[0].name.includes(e.state.name)}))},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.loadTrips(this.state.filterBy)}},{key:"render",value:function(){var e=this.props.trips,t=this.getMostOccDests();return this.getMostOccDests(),r.a.createElement("div",{className:"trip-stock"},r.a.createElement("h2",null,"All Trips plans"),r.a.createElement(Ue,{mostOccDests:t,handleInput:this.handleInput,onsetFilter:this.onsetFilter}),r.a.createElement(Ie,{showModal:this.props.showModal,trips:e}))}}]),a}(n.Component),Pe={loadTrips:A,showModal:_},Fe=Object(d.b)((function(e){return{trips:e.tripReducer.trips}}),Pe)(We),Ye=a(36),Je=(a(140),function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={msg:""},e.onSubmit=function(){var t=Object(g.a)(v.a.mark((function t(a){var n,r,i,s;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),n=a.target,r=n.email,i=n.password,s={email:r.value,password:i.value},t.next=5,e.props.handleForm(s);case 5:t.sent?e.props.closeModal():e.setState({msg:"wrong username or password"});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("form",{className:"login-form flex align-center justify-center column",onSubmit:this.onSubmit},r.a.createElement("input",{className:"styled-input",type:"email",placeholder:"email",name:"email"}),r.a.createElement("input",{className:"styled-input",type:"password",placeholder:"password",name:"password"}),r.a.createElement("button",{className:"styled-button"},"Login"),r.a.createElement("p",null,"not a user? please ",r.a.createElement("span",{onClick:function(){return e.props.handleClick("signup")}},"sign up")),this.state.msg&&r.a.createElement("p",null,this.state.msg))}}]),a}(r.a.Component)),Qe=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={username:"",email:"",password:"",imgUrl:"https://res.cloudinary.com/roidinary/image/upload/v1600790523/Untitled-1_xumtnf.jpg"},e.handleChange=function(t){var a=t.target,n=a.value,r=a.name;e.setState(Object(z.a)(Object(z.a)({},e.state),{},Object(q.a)({},r,n)))},e.onSubmit=function(t){t.preventDefault(),e.props.handleForm(e.state,"signup",e.props.tripToRed)},e}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("form",{onSubmit:this.onSubmit,className:"flex column align-center"},r.a.createElement("input",{type:"text",name:"username",value:this.state.username,placeholder:"Username",onChange:this.handleChange,className:"styled-input"}),r.a.createElement("input",{type:"email",name:"email",value:this.state.email,placeholder:"email",onChange:this.handleChange,className:"styled-input"}),r.a.createElement("input",{type:"password",name:"password",value:this.state.password,placeholder:"password",onChange:this.handleChange,className:"styled-input"}),r.a.createElement("button",{className:"styled-button"},"Sign Up"))}}]),a}(r.a.Component),qe=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={login:!0},e.handleForm=function(){var t=Object(g.a)(v.a.mark((function t(a,n,r){var i,s,o,c,l;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("signup"!==n){t.next=19;break}if(!r){t.next=14;break}return t.next=4,Promise.all([e.props.loadTrip(r),e.props.signup(a)]);case 4:return i=t.sent,s=Object(Ye.a)(i,2),o=s[0],c=s[1],o.members.push({username:c.username,imgUrl:c.imgUrl,id:c._id}),t.next=11,e.props.addTrip(o);case 11:return C.emit("tripToUpdate",o._id),e.props.closeModal(),t.abrupt("return",c);case 14:return t.next=16,e.props.signup(a);case 16:return t.abrupt("return",t.sent);case 19:return t.next=21,e.props.login(a);case 21:if(l=t.sent){t.next=24;break}return t.abrupt("return");case 24:return t.abrupt("return",l);case 25:case"end":return t.stop()}}),t)})));return function(e,a,n){return t.apply(this,arguments)}}(),e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.page!==this.state.login&&this.setState({login:this.props.page})}},{key:"componentDidUpdate",value:function(){this.props.page!==this.state.login&&this.setState({login:this.props.page})}},{key:"closeModal",value:function(){this.props.closeModal()}},{key:"render",value:function(){var e=this,t=this.props.tripId;return this.state.login?r.a.createElement(Je,{handleForm:this.handleForm,handleClick:this.props.handleClick,closeModal:function(){return e.closeModal()}}):r.a.createElement(Qe,{handleForm:this.handleForm,handleClick:this.props.handleClick,closeModal:function(){return e.closeModal()},tripId:this.props.tripId,tripToRed:t})}}]),a}(n.Component),ze={signup:function(e){return function(){var t=Object(g.a)(v.a.mark((function t(a){var n;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,H.signup(e);case 2:return n=t.sent,a({type:"SET_USER",user:n}),t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},login:function(e){return function(){var t=Object(g.a)(v.a.mark((function t(a){var n;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,H.login(e);case 3:return n=t.sent,a({type:"SET_USER",user:n}),t.abrupt("return",n);case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0,"actionsuser"),a({type:"LOGIN_PROBLEM"});case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},closeModal:L,showModal:_,loadTrip:I,addTrip:R},Ve=Object(d.b)((function(e){return{}}),ze)(qe),Ge=a(110);var Ke={on:function(e,t){var a=function(e){var a=e.detail;t(a)};return window.addEventListener(e,a),function(){window.removeEventListener(e,a)}},emit:function(e,t){window.dispatchEvent(new CustomEvent(e,{detail:t}))}},Xe=a(317),$e="activitie",Ze="destination";function et(e){var t=e.act,a=e.onRemoveAct,n=e.onEdit,i=e.destinations,s=e.onOpenDetails,o=Object(Xe.a)({item:{type:$e,id:t.id},collect:function(e){return{isDragging:!!e.isDragging()}}}),c=Object(Ye.a)(o,2),l=c[0].isDragging,u=c[1],p=0===t.col?"first-col":"",d=t.literalDay?"literal-day":"",m=l?"is-drag":"",h=1===t.duration?"len-one":"",f=i.findIndex((function(e){return t.destination===e.name}));return r.a.createElement("div",{ref:u,className:"activity-prev-assembly activity-assembly ".concat(h," ").concat(d," ").concat(p," ").concat(m),style:{gridRow:"".concat(t.row+1||"auto","/span ").concat(t.duration)},key:G.makeId()},r.a.createElement("div",{className:"dest-color dest-"+f}),r.a.createElement("div",{className:"activity-name-container"},r.a.createElement("h5",null,t.name)),r.a.createElement("div",{className:"activity-assembly-details column"},r.a.createElement("div",{className:"activity-assembly-controls flex"},r.a.createElement("button",{onClick:function(){n(t)},className:"edit-activity "},r.a.createElement("i",{className:"fas fa-edit"})),r.a.createElement("button",{onClick:function(){s(t)}},r.a.createElement("i",{className:"fas fa-info"})),r.a.createElement("button",{onClick:function(){a(t.id)},className:"delete-activity "},r.a.createElement("i",{className:"fas fa-trash"})))))}var tt=a(318);function at(e){var t=e.act,a=(e.getRowIdx,e.onDragMove),n=Object(tt.a)({accept:$e,drop:function(e,n){a(t,e.id)},collect:function(e){return{isOver:!!e.isOver()}}}),i=Object(Ye.a)(n,2),s=i[0].isOver,o=i[1],c=0===t.col?"first-col":"",l=t.literalDay?"literal-day":"",u=s?"is-over":"";return r.a.createElement(r.a.Fragment,null,t.literalDay&&r.a.createElement("div",{className:"activity-prev-assembly empty-assembly ".concat(c," ").concat(l,"  ").concat(u),style:{gridRow:"".concat("auto","/span 1")},key:G.makeId()},t.date),!t.literalDay&&r.a.createElement("div",{ref:o,className:"activity-prev-assembly empty-assembly ".concat(c," ").concat(l,"  ").concat(u),style:{gridRow:"".concat("auto","/span 1")},key:G.makeId()},t.date))}function nt(e){var t=e.day,a=e.getRowIdx,n=e.onRemoveAct,i=e.onEdit,s=e.destinations,o=e.onDragMove,c=e.onOpenDetails;var l=function(e){for(var t=[],a=0;a<35;)e[a].id?(t.push(e[a]),a+=e[a].duration):(t.push(e[a]),a++);return t}(t);return r.a.createElement("div",{className:"day-list-assembly"},l.map((function(e,t,l){return e.id?(!0,e.duration,r.a.createElement(et,{destinations:s,onEdit:i,onRemoveAct:n,getRowIdx:a,key:G.makeId(),act:e,onOpenDetails:c})):r.a.createElement(at,{destinations:s,onEdit:i,onRemoveAct:n,getRowIdx:a,key:G.makeId(),act:e,onDragMove:o})})))}function rt(){return r.a.createElement("div",{className:"time-line-assembly"},function(){for(var e=[],t=0;t<35;t++){var a=r.a.createElement("div",{key:G.makeId(),className:"time-assembly"},t%2===0&&r.a.createElement("span",null,"".concat(7+t/2,":00")));e.push(a)}return e}())}function it(e){var t=e.dest,a=(e.updateFreeDays,e.freeDays,e.destinations.findIndex((function(e){return e.name===t.name}))),n=t.duration?"":"none";return r.a.createElement("div",{className:"dest-name-preview dest-head-".concat(a," "),style:{gridColumn:"span ".concat(t.duration),display:n}},t.name)}function st(e){var t=e.destinations,a=e.allDestinations,n=e.daysCount;return t.sort((function(e,t){return e.time.startDate-t.time.startDate})),r.a.createElement("div",{className:"destinations-header",style:{gridTemplateColumns:"repeat(".concat(2*n,", minmax(25px, 1fr))")}},t.map((function(e,t){return r.a.createElement(it,{destinations:a,idx:t,key:G.makeId(),dest:e})})))}var ot=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={activities:null,weekMat:null,page:0,startDate:null,endDate:null,tripLength:"",actsToDisplay:null,minDestinations:null,daysCount:7},e.setChosenDay=function(){var t=Object(g.a)(v.a.mark((function t(a){var n,r,i;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.getLinearTripDays().map((function(e){return new Date(e).toLocaleDateString()})),r=a.day.toLocaleDateString(),i=n.findIndex((function(e){return e===r})),e.props.openSideBar(),e.initiateAssembly(1,i);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.initiateAssembly=Object(g.a)(v.a.mark((function t(){var a,n,r,i,s,o,c,l,u,p,d=arguments;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=d.length>0&&void 0!==d[0]?d[0]:7,n=d.length>1&&void 0!==d[1]?d[1]:0,r=e.props.trip,i=r.destinations,s=r.activities,o=window.window.innerWidth,7===a&&(o<=900&&(a=5),o<=650&&(a=3),o<=530&&(a=2)),u=[i[0].startDate,i[i.length-1].endDate],c=u[0],l=u[1],p=G.calculateDays(c,l),t.next=11,e.setState(Object(z.a)(Object(z.a)({},e.state),{},Object(q.a)({tripLength:p,startDate:c,endDate:l,activities:s,daysCount:a,page:n},"daysCount",a)),(function(){return e.loadWeekMat()}));case 11:return t.next=13,e.setState({minDestinations:e.getMinDestinations()});case 13:case"end":return t.stop()}}),t)}))),e.loadWeekMat=function(){for(var t=e.props.trip.activities,a=e.mapActsToDays(t).slice(e.state.page*e.state.daysCount,e.state.page*e.state.daysCount+e.state.daysCount),n=a[0][1][0].at,r=G.getDateDay(n),i=G.createMat(e.state.daysCount,35),s=0,o=a[0][0],c=0;c<a.length;c++){var l=void 0,u=void 0,p=[a[c][0],a[c][1]];u=p[1],o>(l=p[0])&&(l+=e.getDaysInMonth(n)),o=l,s=l-r,u.forEach((function(t){if(!t.freeDay){var a=e.getRowIdx(t.at);t=Object(z.a)(Object(z.a)({},t),{},{col:s,row:a}),i[a][s]=t}}))}i=e.showDaysName(n,i),e.setState({weekMat:i,actsToDisplay:a})},e.onRemoveAct=function(t){e.props.showModal("removeActivity",{removeAct:e.removeAct,actId:t})},e.removeAct=function(){var t=Object(g.a)(v.a.mark((function t(a){var n;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state.activities,t.next=3,n.filter((function(e){return e.id!==a}));case 3:return n=t.sent,t.next=6,e.props.updateTripAct(n);case 6:return t.next=8,e.setState({activities:n});case 8:return t.next=10,e.props.closeModal();case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.isOccTimeSlot=function(t){for(var a=e.state.activities,n=t.at,r=n+30*t.duration*60*1e3,i=0;i<a.length;i++){var s=a[i],o=s.at,c=s.at+30*s.duration*60*1e3;if((!t.id||t.id!==s.id)&&(n>o&&n<c||r>o&&r<c||o>n&&o<r||c>n&&c<r))return!0}return!1},e.mapActsToDays=function(){var t=e.props.trip,a=t.activities;t.destinations;a.sort((function(e,t){return e.at-t.at}));var n=a.reduce((function(e,t){var a=G.getDateDay(t.at);return e[a]||(e[a]=[]),e[a].push(t),e}),{});return n=e.sortDateMap(n)},e.getCol=function(e,t){var a;return a=t,e.map((function(e){return e[a]}))},e.onEdit=function(t){e.props.showModal("editActivity",{saveAct:e.saveAct,act:t,isOccTimeSlot:e.isOccTimeSlot,destinations:e.props.trip.destinations})},e.onOpenDetails=function(t){e.props.showModal("activityDetails",{saveAct:e.saveAct,act:t,isOccTimeSlot:e.isOccTimeSlot,destinations:e.props.trip.destinations})},e.onDragMove=function(t,a){var n=t.pos,r=e.state.activities.find((function(e){return e.id===a})),i=e.props.trip.destinations.find((function(e){return e.name===r.destination})),s=e.getTimeFromIdx(n),o=G.setToHourMinuets(i.startDate,6,0),c=G.setToHourMinuets(i.endDate,23,59);if(s<o||s>c)e.props.showMsg({type:"invalid-move",msg:"Cannot move activities to another destination!"});else if(s){var l=Object(z.a)(Object(z.a)({},r),{},{at:s});e.isOccTimeSlot(l)?e.props.showMsg({type:"invalid-move",msg:"You aleardy have plans for that date! please choose a different one."}):(r.at=s,e.saveAct(r))}},e.getTimeFromIdx=function(t){var a=t.i,n=t.j,r=e.state.page,i=e.getLinearTripDays();if(n+r*e.state.daysCount>=i.length)return!1;var s=new Date(i[n+r*e.state.daysCount]);return a%2!==0?s.setHours(7+(a-1)/2,0):s.setHours(6+a/2,30),s.getTime()},e.saveAct=function(t){var a=e.state.activities;t.id?a=a.map((function(e){return e.id===t.id?t:e})):(t.id=G.makeId(),a.push(t)),e.props.closeModal(),e.props.updateTripAct(a),e.setState({activities:a}),e.loadWeekMat()},e.getWeekDests=function(){var t=e.state,a=t.page,n=t.daysCount,r=e.props.trip.destinations,i=e.getLinearTripDays(),s=i[a*n],o=a*n;o+n-1>=i.length?o=i.length-1:o+=n-1;var c=i[o];return s=new Date(s),c=new Date(c),s=G.setToHourMinuets(s,7,0),c=G.setToHourMinuets(c,23,59),r.filter((function(e){var t=new Date(e.startDate),a=new Date(e.endDate);return t=G.setToHourMinuets(t,10,0),a=G.setToHourMinuets(a,10,0),t>=s&&t<=c||a>=s&&a<=c}))},e.getMinDestinations=function(){for(var t=e.getWeekDests(),a=(e.state.page,[]),n=e.mapDestsToHeaderLength(),r=Object.keys(n),i=Object.values(n),s=function(e){var n=t.find((function(t){return t.name===r[e]}));a.push({name:r[e],duration:i[e],time:n})},o=0;o<r.length;o++)s(o);return a},e.mapDestsToHeaderLength=function(){var t,a,n=e.props.trip,r=e.state.page,i=e.props.trip.destinations,s=n.destinations[0].startDate,o=n.destinations[n.destinations.length-1].endDate,c=n.destinations.map((function(e,t){return{start:new Date(e.startDate),end:new Date(e.endDate),idx:t}}));return G.calculateDates(s,o,c).slice(r*e.state.daysCount,r*e.state.daysCount+e.state.daysCount).reduce((function(e,n,r){var s=n.td;return s.full||0===s.full?(a=i[s.full],e[t=a.name]=e[t]?e[t]+2:2):!s.start&&0!==s.start||s.end||0===s.end?((s.start||0===s.start)&&(a=i[s.start],e[t=a.name]=e[t]?e[t]+1:1),(s.end||0===s.end)&&(a=i[s.end],e[t=a.name]=e[t]?e[t]+1:1)):(a=i[s.start],e[t=a.name]=e[t]?e[t]+2:2),e}),{})},e.getLinearTripDays=function(){for(var t=[],a=e.state,n=a.startDate,r=a.tripLength,i=(new Date(n),0);i<r;i++)t.push(n+24*i*60*60*1e3);return t},e.getDestsWithActs=function(t,a){return t=t.filter((function(t){return e.isActInDests(t,a)}))},e.getRowIdx=function(e){var t=new Date(e),a=t.getHours();return 0===t.getMinutes()?2*(a-6)-1:2*(a-6)},e.onTogglePage=function(){var t=Object(g.a)(v.a.mark((function t(a){var n,r,i,s,o;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state,r=n.tripLength,i=n.page,s=Math.ceil(r/e.state.daysCount),o="next"===a?(i+1)%s:i-1<0?s-1:i-1,t.next=5,e.setState({page:o});case 5:return t.next=7,e.loadWeekMat();case 7:e.setState({minDestinations:e.getMinDestinations()});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getDayNumOfAct=function(e){return e.reduce((function(e,t){return e+=t.id?1:0}),0)},e.getTwoDig=function(e){var t=e+"";return 1===t.length?"0"+t:t},e.setFullAssembly=function(){e.initiateAssembly(7,0)},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(g.a)(v.a.mark((function e(){var t,a=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Ke.on("markDay",(function(e){a.setChosenDay(e)})),this.removeBus=t,this.initiateAssembly();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e,t){e.trip!==this.props.trip&&this.initiateAssembly(this.state.daysCount,this.state.page)}},{key:"omponentWillUnmount",value:function(){this.removeBus()}},{key:"showDaysName",value:function(e,t){for(var a=0;a<this.state.daysCount;a++){var n=e+24*a*Math.pow(60,2)*1e3,r=new Date(n);t[0][a]={duration:1,literalDay:G.getWeekDay(n),date:r.toLocaleDateString(),time:r}}return t}},{key:"sortDateMap",value:function(e){var t=[];for(var a in e)t.push([+a,e[a]]);for(var n=this.getLinearTripDays(),r=function(e){var a=G.getDateDay(n[e]);t.find((function(e){return e[0]===a}))||t.push([a,[{at:n[e],freeDay:!0}]])},i=0;i<n.length;i++)r(i);return t.sort((function(e,t){return e[1][0].at-t[1][0].at})),t}},{key:"getDaysInMonth",value:function(e){var t=new Date(e),a=[t.getMonth(),t.getFullYear()];return new Date(a[1],a[0]+1,0).getDate()}},{key:"isActInDests",value:function(e,t){var a,n=Object(Ge.a)(t);try{for(n.s();!(a=n.n()).done;){var r,i=a.value[1],s=Object(Ge.a)(i);try{for(s.s();!(r=s.n()).done;){if(r.value.destination===e.name)return!0}}catch(o){s.e(o)}finally{s.f()}}}catch(o){n.e(o)}finally{n.f()}return!1}},{key:"renderDayActivities",value:function(e){for(var t=[],a=0;a<e[0].length;a++){var n=this.getCol(e,a);t.push(r.a.createElement(nt,{onDragMove:this.onDragMove,getTimeFromIdx:this.getTimeFromIdx,destinations:this.props.trip.destinations,onEdit:this.onEdit,onOpenDetails:this.onOpenDetails,onRemoveAct:this.onRemoveAct,getRowIdx:this.getRowIdx,key:G.makeId(),day:n}))}return t}},{key:"render",value:function(){var e=this,t=this.state,a=t.weekMat,n=t.minDestinations,i=t.daysCount,s=this.props.trip.destinations;if(!a||!n)return r.a.createElement("div",null,"Loading...");var o=this.renderDayActivities(a);return this.mapDestsToHeaderLength(),r.a.createElement("div",{className:"assembly-container"},1!==i&&r.a.createElement("div",{className:"destinations-header-wraper"},r.a.createElement("div",{className:"toggle-page prev",onClick:function(){return e.onTogglePage("prev")}},r.a.createElement("i",{className:"fas fa-chevron-circle-left"})),r.a.createElement("div",{className:"toggle-page next",onClick:function(){return e.onTogglePage("next")}},r.a.createElement("i",{className:"fas fa-chevron-circle-right"}))),1===i&&r.a.createElement("section",{className:"full-assembly"},r.a.createElement("button",{className:"styled=button",onClick:this.setFullAssembly},"Back")),r.a.createElement(st,{daysCount:i,allDestinations:s,destinations:n}),r.a.createElement("div",{className:"trip-assembly-main full",style:{gridTemplateColumns:"repeat(".concat(i,", minmax(70px, 1fr))")}},r.a.createElement(rt,null),o),r.a.createElement("button",{className:"editActivity styled-button",onClick:function(){return e.props.showModal("editActivity",{saveAct:e.saveAct,isOccTimeSlot:e.isOccTimeSlot,act:null,destinations:e.props.trip.destinations})}},"add activity"))}}]),a}(n.Component);function ct(e){var t=e.member.imgUrl||"https://res.cloudinary.com/roidinary/image/upload/v1600790523/Untitled-1_xumtnf.jpg";return r.a.createElement("div",{className:"member-preview"},r.a.createElement("img",{className:"image-preview",src:t}),r.a.createElement("div",{className:"is-active-circle"}))}var lt=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={addDestOpen:!1,destination:{name:"",days:"",location:null}},e.handleAddress=function(t){e.setState({destination:Object(z.a)(Object(z.a)({},e.state.destination),{},{name:t})})},e.handleSelect=function(){var t=Object(g.a)(v.a.mark((function t(a){var n,r;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(se.geocodeByAddress)(a);case 3:return n=t.sent,t.next=6,Object(se.getLatLng)(n[0]);case 6:r=t.sent,e.setState({destination:Object(z.a)(Object(z.a)({},e.state.destination),{},{location:r,name:a})}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.log(t.t0,"err");case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}(),e.handleChange=function(t){var a=t.target,n=a.name,r=a.value;e.setState({destination:Object(z.a)(Object(z.a)({},e.state.destination),{},Object(q.a)({},n,r))})},e.onSubmit=function(t){t.preventDefault(),e.toggleAddDestination(),e.props.addDestination(e.state.destination),e.setState({destination:{name:"",days:"",location:null}})},e.toggleAddDestination=function(){e.setState({addDestOpen:!e.state.addDestOpen})},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.setState({destination:{name:"",days:"",location:null}})}},{key:"render",value:function(){var e=this.state.addDestOpen?"form-open":"";return r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fas fa-plus add-destination-button",onClick:this.toggleAddDestination}),r.a.createElement("div",{className:"add-destination column ".concat(e)},r.a.createElement("div",{className:"styled-header"},"Add destination"),r.a.createElement("form",{onSubmit:this.onSubmit,className:"add-destination-form  "},r.a.createElement("input",{type:"text",placeholder:"Enter destination",name:"name",value:this.state.destination.name,onChange:this.handleChange}),r.a.createElement("input",{type:"number",placeholder:"Number of days",name:"days",value:this.state.destination.days,onChange:this.handleChange}),r.a.createElement("button",{className:"styled-button"},"Add!")),r.a.createElement("div",{className:"add-destination-footer"})))}}]),a}(r.a.Component);function ut(e){var t=e.dates,a=e.showDay;return r.a.createElement("tr",{key:G.makeId()},t.map((function(e,t){return r.a.createElement("td",{onClick:function(){return a(e)},className:"".concat(e.td?"":"faded"),key:t},new Date(e.day).getDate(),function(e){if(e.td)return Object.keys(e.td).map((function(t){var a="dest-".concat(e.td[t]," ").concat(t);return r.a.createElement("div",{key:G.makeId(),className:a})}))}(e))})))}function pt(e){var t=e.trip,a=e.showDay;var n=function(){var e=t.destinations[0].startDate,a=t.destinations[t.destinations.length-1].endDate;return function(e,t,a){!function(e,t){var a=new Date(e);for(;a.getDay()>0;)a=new Date(a.getTime()-864e5),t.unshift({day:a})}(t,e);return function(e,t){var a=new Date(e);for(;a.getDay()<6;)a=new Date(a.getTime()+864e5),t.push({day:a});return t}(a,e)}(function(e,t,a){var n=new Date(e),r=[{day:n,td:{start:0}}];for(;n.getDate()!==new Date(t).getDate();)n=new Date(n.getTime()+864e5),r.push({day:n,td:""}),a.forEach((function(e){e.start.getDate()===n.getDate()&&e.start.getMonth()===n.getMonth()?r[r.length-1].td=Object(z.a)(Object(z.a)({},r[r.length-1].td),{},{start:e.idx}):e.start<n&&n.setHours(12)<e.end.setHours(11)?r[r.length-1].td=Object(z.a)(Object(z.a)({},r[r.length-1].td),{},{full:e.idx}):e.end.getDate()===n.getDate()&&e.end.getMonth()===n.getMonth()&&(r[r.length-1].td=Object(z.a)(Object(z.a)({},r[r.length-1].td),{},{end:e.idx}))}));return r}(e,a,t.destinations.map((function(e,t){return{start:new Date(e.startDate),end:new Date(e.endDate),idx:t}}))),e,a)}();return r.a.createElement("table",{className:"route-calendar"},r.a.createElement("thead",{className:"table-header"},r.a.createElement("tr",null,r.a.createElement("th",null,"S"),r.a.createElement("th",null,"M"),r.a.createElement("th",null,"T"),r.a.createElement("th",null,"W"),r.a.createElement("th",null,"T"),r.a.createElement("th",null,"F"),r.a.createElement("th",null,"S"))),r.a.createElement("tbody",null,function(e){var t=[];if(e.length%7!==0)return null;for(var n=e.length/7;n;)t.push(r.a.createElement(ut,{showDay:a,key:G.makeId(),dates:e.splice(0,7)})),n--;return t}(n)||"w"))}function dt(e){var t=e.destination,a=e.idx,n=e.isLast,i=e.updateDestinations,s=Object(Xe.a)({item:{type:Ze,id:a},collect:function(e){return{isDragging:!!e.isDragging()}}}),o=Object(Ye.a)(s,2),c=o[0].isDragging,l=o[1],u=Object(tt.a)({accept:Ze,drop:function(e,t){e.id!==a&&i(e.id,a)},collect:function(e){return{isOver:!!e.isOver()}}}),p=Object(Ye.a)(u,2),d=p[0].isOver,m=p[1],h=d?"is-dragging":"",f=c?"on":"";return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"fire-ring ".concat(f)}),r.a.createElement("div",{ref:m,className:"time-line-area flex align-center"},r.a.createElement("div",{className:"route-time-line-context flex align-center "},r.a.createElement("div",{ref:l,className:"index-ball dest-".concat(a," flex align-center justify-center  ").concat(h," ")},r.a.createElement("p",null,a+1)),r.a.createElement("div",{className:"time-line-text"},r.a.createElement("p",null,t.name),r.a.createElement("p",null,G.calculateDays(t.startDate,t.endDate)-1," Nights")))),!n&&r.a.createElement("div",{className:"line"}))}function mt(e){var t=e.trip,a=e.updateDestinations;return r.a.createElement("div",{className:"route-time-line"},t.destinations.map((function(e,n){return r.a.createElement(dt,{key:G.makeId(),destination:e,idx:n,isLast:n+1===t.destinations.length,updateDestinations:a})})))}function ht(e){var t=e.trip,a=e.updateDestinations,n=e.showModal,i=e.addDestination,s=e.toggleChat,o=e.showDay,c=e.setDestsMarkers,l=Object(tt.a)({accept:Ze,drop:function(e,t){a(e.id,-1)},collect:function(e){return{isOver:!!e.isOver()}}}),u=Object(Ye.a)(l,2),p=(u[0].isOn,u[1]);return r.a.createElement("div",{className:"trip-route flex column"},r.a.createElement("div",{className:"members-preview flex justify-between align-center"},t.members.map((function(e,t){return r.a.createElement(ct,{key:t,member:e})})),r.a.createElement("button",{className:"ustyled-button add-user-btn",onClick:function(){return n("add-member",t._id)}},r.a.createElement("i",{className:"fas fa-user-plus "}))),r.a.createElement(pt,{trip:t,showDay:o}),r.a.createElement("div",{className:"all-destinations-area"},r.a.createElement("div",{className:"trip-bar-icons trip-bar-destinations-icons flex justify-between"},r.a.createElement(lt,{addDestination:i}),r.a.createElement("i",{ref:p,className:"fas fa-trash "}),r.a.createElement("i",{className:"fas fa-map-marked-alt",onClick:c})),r.a.createElement(mt,{trip:t,updateDestinations:a})),r.a.createElement("div",{className:"trip-bar-icons flex justify-between flex1 align-end"},r.a.createElement("img",{onClick:function(){return n("trip-reviews")},className:"reviews-btn",src:"https://res.cloudinary.com/idanrozen/image/upload/v1601286406/6719970451595452853_wdwgqc.svg",alt:""}),r.a.createElement("i",{className:"fas fa-comments",onClick:s})))}var ft=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={msg:{from:e.props.loggedInUser?e.props.loggedInUser.username:"Traveler",txt:""},msgs:[],isTyping:""},e.loadHistory=function(t){e.setState({msgs:t||[]})},e.addMsg=function(t){e.setState((function(e){return{msgs:[].concat(Object(V.a)(e.msgs),[t])}}))},e.sendMsg=function(t){t.preventDefault(),C.emit("chat newMsg",e.state.msg),C.emit("stopTyping","");var a=e.props.loggedInUser?e.props.loggedInUser.username:"Traveler";e.setState({msg:{from:a,txt:""}})},e.userTyping=function(t){e.setState({isTyping:t})},e.msgHandleChange=function(t){var a=t.target,n=a.name,r=a.value;if(r.trim().length>0){var i=e.props.loggedInUser?e.props.loggedInUser.username:"Traveler";C.emit("user typing",i)}else C.emit("stopTyping","");e.setState((function(e){return{msg:Object(z.a)(Object(z.a)({},e.msg),{},Object(q.a)({},n,r))}}))},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){C.on("chat addMsg",this.addMsg),C.on("isTyping",this.userTyping),C.on("notTyping",this.userTyping)}},{key:"componentWillUnmount",value:function(){C.off("chat addMsg",this.addMsg),C.off("isTyping",this.userTyping),C.off("notTyping",this.userTyping),C.terminate()}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"chat-container flex column  ".concat(this.props.chatOpen?"open":"")},r.a.createElement("div",{className:"chat-header styled-header"},this.props.trip.destinations[0].name," Chat"),r.a.createElement("ul",{className:"chat-history"},this.state.msgs.map((function(t,a){return r.a.createElement("li",{key:a},r.a.createElement("div",{className:"message-data"},e.props.loggedInUser?e.props.loggedInUser.username===t.from?"Me":t.from:"Traveler"===t.from?"Traveler":t.from),r.a.createElement("div",{className:"message"},t.txt))}))),this.props.loggedInUser?this.state.isTyping&&this.state.isTyping!==this.props.loggedInUser.username?r.a.createElement("p",null,this.state.isTyping," is Typing"):"":this.state.isTyping&&!this.state.msg.txt.trim().length?r.a.createElement("p",null,this.state.isTyping," is Typing"):"",r.a.createElement("form",{className:"chat-send flex align-center",onSubmit:this.sendMsg},r.a.createElement("input",{type:"text",value:this.state.msg.txt,onChange:this.msgHandleChange,name:"txt",autoComplete:"off",placeholder:"New message"}),r.a.createElement("button",null,r.a.createElement("i",{className:"far fa-paper-plane"}))))}}]),a}(n.Component),vt=Object(d.b)((function(e){return{loggedInUser:e.userReducer.loggedInUser}}),{})(ft),gt=a(66),yt=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={bounds:"",markers:[],selectedPlace:"",activeMarker:{},showingInfoWindow:!1},e.onMarkerClick=function(t,a,n){return e.setState({selectedPlace:t,activeMarker:a,showingInfoWindow:!0})},e.onMapClicked=function(t){e.state.showingInfoWindow&&e.setState({showingInfoWindow:!1,activeMarker:null})},e.containerStyle={width:"100%",height:"300px"},e}return Object(l.a)(a,[{key:"initiateMarkerABounds",value:function(){for(var e=[],t=new this.props.google.maps.LatLngBounds,a=0;a<this.props.markers.length;a++)this.props.markers[a].location&&this.props.markers[a].location.lng&&(t.extend(new this.props.google.maps.LatLng(this.props.markers[a].location)),e.push(this.props.markers[a]));return{markers:e,bounds:t}}},{key:"componentDidMount",value:function(){var e=this.initiateMarkerABounds(),t=e.markers,a=e.bounds,n="https://res.cloudinary.com/roidinary/image/upload/c_scale,w_40/v1601311538/",r=["".concat(n,"location1_xebwou.png"),"".concat(n,"location2_lxtqsq.png"),"".concat(n,"location3_zly9ql.png"),"".concat(n,"location4_venppr.png"),"".concat(n,"location5_xervod.png"),"".concat(n,"location6_fql1xk.png")];this.setState({bounds:a,markers:t,imgs:r})}},{key:"componentDidUpdate",value:function(e,t){if(this.props.markers!==e.markers){var a=this.initiateMarkerABounds(),n=a.markers,r=a.bounds;n.length>1&&this.state.map?this.state.map.fitBounds(r):this.state.map&&n[0]&&n[0].location&&n[0].location.lat&&(this.state.map.panTo(this.props.markers[0].location),this.state.map.setZoom(10)),this.setState({markers:n})}}},{key:"getMarkers",value:function(){var e=this;return this.state.markers.map((function(t,a){return r.a.createElement(gt.Marker,{key:G.makeId(),onClick:e.onMarkerClick,title:t.name,name:t.at||"",position:t.location,icon:e.state.imgs[a]})}))}},{key:"render",value:function(){var e=this;return r.a.createElement(gt.Map,{google:this.props.google,containerStyle:this.containerStyle,zoom:10,onClick:this.onMapClicked,onReady:function(t,a){e.state.markers.length>1?a.fitBounds(e.state.bounds):e.state.markers[0]&&a.panTo(e.state.markers[0].location),e.setState({map:a})},styles:[{featureType:"all",elementType:"labels.text.fill",stylers:[{saturation:36},{color:"#333333"},{lightness:40}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#ffffff"},{lightness:16}]},{featureType:"all",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#fefefe"},{lightness:20}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#fefefe"},{lightness:17},{weight:1.2}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#f5f5f5"},{lightness:20}]},{featureType:"landscape",elementType:"geometry.fill",stylers:[{color:"#d5d5d5"}]},{featureType:"landscape.man_made",elementType:"geometry.fill",stylers:[{color:"#7574c0"},{saturation:"-37"},{lightness:"75"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#f5f5f5"},{lightness:21}]},{featureType:"poi.business",elementType:"geometry.fill",stylers:[{color:"#7574c0"},{saturation:"-2"},{lightness:"53"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#dedede"},{lightness:21}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#7574c0"},{lightness:"69"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#7574c0"},{lightness:"25"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#ffffff"},{lightness:29},{weight:.2}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{lightness:"38"},{color:"#000000"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#ffffff"},{lightness:18}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#ffffff"},{lightness:16}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#f2f2f2"},{lightness:19}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#e9e9e9"},{lightness:17}]}]},this.state.markers[0]&&this.getMarkers(),r.a.createElement(gt.InfoWindow,{marker:this.state.activeMarker,visible:this.state.showingInfoWindow},r.a.createElement("div",null,r.a.createElement("h1",null,this.state.selectedPlace.title),this.state.selectedPlace.name&&r.a.createElement("p",null,new Date(this.state.selectedPlace.name).getHours()+":"+new Date(this.state.selectedPlace.name).getMinutes()))))}}]),a}(r.a.Component),bt=Object(gt.GoogleApiWrapper)({apiKey:"AIzaSyBXIyfwpDtmz9fLAQI-MUqWuhQtc-GQYoo"})(yt),Et=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={chatOpen:!1,settingsOpen:!1,isSocketSetup:!1,markers:[],sideBar:!1},e.setDestsMarkers=function(){var t=e.getMarkersOfDests();e.setState({markers:t})},e.updateDestinations=function(){var t=Object(g.a)(v.a.mark((function t(a,n){var r,i,s,o,c,l,u,p,d,m,h;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Object(V.a)(e.props.trip.destinations),i=Object(V.a)(e.props.trip.activities),s=G.calculateDays(r[a].startDate,r[a].endDate),o=r.splice(a,1)[0],c=864e5*(s-1),-1===n?(i=i.reduce((function(e,t,a){return t.destination===o.name||e.push(t),e}),[]),r.forEach((function(e,t){t>=a&&(e.startDate=e.startDate-c,e.endDate=e.endDate-c,i.forEach((function(t){t.destination===e.name&&(t.at-=c)})))}))):a>n?(l=G.calculateDays(e.props.trip.destinations[n].startDate,e.props.trip.destinations[a-1].endDate),u=864e5*(l-1),o.startDate=o.startDate-u,o.endDate=o.endDate-u,i.forEach((function(e){e.destination===o.name&&(e.at-=u)})),r.splice(n,0,o),r.forEach((function(e,t){t>n&&t<=a&&(e.startDate=e.startDate+c,e.endDate=e.endDate+c,i.forEach((function(t){t.destination===e.name&&(t.at+=c)})))}))):(p=G.calculateDays(e.props.trip.destinations[a+1].startDate,e.props.trip.destinations[n].endDate),d=864e5*(p-1),o.startDate=o.startDate+d,o.endDate=o.endDate+d,i.forEach((function(e){e.destination===o.name&&(e.at+=d)})),r.splice(n,0,o),r.forEach((function(e,t){t<n&&t>=a&&(e.startDate=e.startDate-c,e.endDate=e.endDate-c,i.forEach((function(t){t.destination===e.name&&(t.at-=c)})))}))),m=Object(z.a)(Object(z.a)({},e.props.trip),{},{activities:i,destinations:r}),t.next=9,e.props.addTrip(m);case 9:h=t.sent,C.emit("tripToUpdate",h);case 11:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),e.updateTripAct=function(){var t=Object(g.a)(v.a.mark((function t(a){var n,r;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Object(z.a)(Object(z.a)({},e.props.trip),{},{activities:a}),t.next=3,e.props.addTrip(n);case 3:r=t.sent,C.emit("tripToUpdate",r);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.toggleChat=function(){e.setState({chatOpen:!e.state.chatOpen})},e.toggleSettings=function(){e.setState({settingsOpen:!e.state.settingsOpen})},e.addDestination=function(){var t=Object(g.a)(v.a.mark((function t(a){var n,r,i,s;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Object(z.a)({},e.props.trip),r=n.destinations,a.startDate=r[r.length-1].endDate,a.endDate=a.startDate+864e5*(+a.days-1),a.id=G.makeId(),r.push(a),i=Object(z.a)(Object(z.a)({},e.props.trip),{},{destinations:r}),t.next=8,e.props.addTrip(i);case 8:s=t.sent,C.emit("tripToUpdate",s);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.showDay=function(t){var a=e.props.trip.activities.reduce((function(e,a){return new Date(a.at).getDate()===t.day.getDate()&&e.push({name:a.name,location:a.location,at:a.at}),e}),[]);Ke.emit("markDay",t),e.setState({markers:a})},e.openSideBar=function(){e.setState({sideBar:!e.state.sideBar})},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(g.a)(v.a.mark((function e(){var t,a,n,r,i;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,a=t.setTrip,n=t.loadTrip,t.addTrip,C.setup(),r=this.props.match.params.id,C.emit("enter trip",r),e.prev=4,e.next=7,n(r,!0);case 7:"true"===this.props.match.params.openSignup&&this.props.showModal("signup",r),i=this.getMarkersOfDests(),this.setState({isSocketSetup:!0,markers:i}),e.next=14;break;case 12:e.prev=12,e.t0=e.catch(4);case 14:C.on("tripUpdated",a);case 15:case"end":return e.stop()}}),e,this,[[4,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"getMarkersOfDests",value:function(){return this.props.trip.destinations.map((function(e){return{location:e.location,name:e.name}}))}},{key:"componentWillUnmount",value:function(){C.off("tripUpdated",this.props.setTrip)}},{key:"componentDidUpdate",value:function(){var e=Object(g.a)(v.a.mark((function e(t,a){var n;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.trip!==this.props.trip){e.next=2;break}return e.abrupt("return");case 2:n=this.getMarkersOfDests(),this.setState({markers:n});case 4:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.trip,t=this.state.sideBar?"open-side-bar":"";return e&&e.destinations?r.a.createElement("div",{className:"trip-app  "},r.a.createElement(ie,null),r.a.createElement("div",{className:"trip-app-area flex "},r.a.createElement("button",{onClick:this.openSideBar,className:"side-bar-bars ".concat(t)},r.a.createElement("i",{className:"fas fa-bars "})),r.a.createElement("div",{className:"trip-side-bar flex column ".concat(t," ")},r.a.createElement(ht,{trip:e,addDestination:this.addDestination,updateDestinations:this.updateDestinations,showModal:this.props.showModal,toggleChat:this.toggleChat,showDay:this.showDay,openSideBar:this.openSideBar,setDestsMarkers:this.setDestsMarkers})),r.a.createElement("div",{className:"trip-app-main full"},this.state.markers[0]&&r.a.createElement(bt,{markers:this.state.markers}),r.a.createElement(ot,{showMsg:this.props.showMsg,closeMsg:this.props.closeMsg,trip:e,updateTripAct:this.updateTripAct,showModal:this.props.showModal,closeModal:this.props.closeModal,setTrip:this.props.setTrip,openSideBar:this.openSideBar}))),this.state.isSocketSetup&&r.a.createElement(vt,{chatOpen:this.state.chatOpen,trip:e})):r.a.createElement("div",null,"Loading....")}}]),a}(n.Component),wt={loadTrip:I,showModal:_,closeModal:L,addTrip:R,showMsg:te,closeMsg:ae,setTrip:function(e){return function(){var t=Object(g.a)(v.a.mark((function t(a){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a({type:"SET_LOADER"}),a({type:"SET_TRIP",trip:e}),a({type:"CLOSE_LOADER"}),t.abrupt("return",e);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},Ot=Object(d.b)((function(e){return{trip:e.tripReducer.currTrip}}),wt)(Object(o.o)(Et)),Dt=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",null)}}]),a}(n.Component),jt=Object(d.b)((function(e){return{}}),{})(Dt),kt=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={activitie:{name:"",at:"",time:"",labels:["relax"],duration:1,notes:"",price:"",destination:"",id:null},minTime:"",maxTime:""},e.handleTime=function(t){var a=6e4*t.getTimezoneOffset(),n=new Date(t-a).toISOString().slice(0,-1);e.setState({activitie:Object(z.a)(Object(z.a)({},e.state.activitie),{},{at:n})})},e.handleChange=function(t){var a=t.target,n=a.name,r=a.value;"checkbox"===a.type?e.setState(Object(q.a)({},n,a.checked)):"number"===a.type?e.setState({activitie:Object(z.a)(Object(z.a)({},e.state.activitie),{},Object(q.a)({},n,+r))}):e.setState({activitie:Object(z.a)(Object(z.a)({},e.state.activitie),{},Object(q.a)({},n,r))})},e.onSaveAct=function(t){t.preventDefault();var a=e.props.props,n=a.saveAct,r=a.isOccTimeSlot,i=e.state.activitie;if(i.at){var s=new Date(i.at);i.at=s.getTime(),r(i)||(i.price={amount:i.price,currency:"$"},n(e.state.activitie))}},e.getValidTime=function(){return new Date(e.state.activitie.at)},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(g.a)(v.a.mark((function e(){var t,a,n,r,i,s;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props.props,a=t.act,n=t.destinations,a?(s=n.findIndex((function(e){return e.name===a.destination})),r=G.getIsoTime(n[s].startDate),i=G.getIsoTime(n[s].endDate),this.setState({activitie:Object(z.a)(Object(z.a)({},a),{},{name:a.name,price:a.price.amount,at:G.getIsoTime(a.at),destination:a.destination}),minTime:r,maxTime:i})):(r=G.getIsoTime(n[0].startDate),new Date(r),i=G.getIsoTime(n[n.length-1].endDate),this.setState({activitie:Object(z.a)(Object(z.a)({},this.state.activitie),{},{destination:n[0].name}),minTime:r,maxTime:i}));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e,t){var a=this.props.props.destinations,n=this.state.activitie.destination;if(t.activitie.destination!==n&&n&&!this.state.activitie.id){var r=a.findIndex((function(e){return e.name===n})),i=G.getIsoTime(a[r].startDate),s=G.getIsoTime(a[r].endDate);this.setState({minTime:i,maxTime:s})}}},{key:"render",value:function(){var e,t=this,a=this.state,n=a.activitie,i=a.minTime,s=a.maxTime;if(!n)return r.a.createElement("div",null,"Loading");var o,c=this.props.props.destinations,l=new Date(i),u=new Date(s),p=l.setHours(7,0),d=(o=n.at?new Date(n.at):new Date(p)).setHours(7,0),m=o.setHours(23,59),h=new Date(d),f=new Date(m);return r.a.createElement("form",{className:"edit-activity-form flex column",onSubmit:this.onSaveAct},r.a.createElement("label",{htmlFor:"name"},"Name"),r.a.createElement("input",{className:"styled-input",placeholder:"name",name:"name",id:"name",value:this.state.activitie.name,onChange:this.handleChange}),!n.id&&r.a.createElement("label",{htmlFor:"dest-input"},"Destination"),!n.id&&r.a.createElement("select",{value:this.state.activitie.destination,placeholder:"destination",name:"destination",id:"dest-input",onChange:this.handleChange},c.map((function(e,t){return r.a.createElement("option",{key:G.makeId(),value:e.name},e.name)}))),r.a.createElement("label",{htmlFor:"start-time-activity-input"},"Time"),r.a.createElement(ee.a,{minDate:l,maxDate:u,selected:this.getValidTime().getTime()||p,value:this.getValidTime().getTime()||p,minTime:h,maxTime:f,autoComplete:"off",className:"styled-input",showTimeSelect:!0,required:!0,showFullMonthYearPicker:!0,dateFormat:"Pp",onChange:function(e){return t.handleTime(e)}}),r.a.createElement("label",{htmlFor:"duration"},"Duration (Half hours)"),r.a.createElement("input",{className:"styled-input",placeholder:"duration",id:"duration",type:"number",name:"duration",value:this.state.activitie.duration,onChange:this.handleChange}),r.a.createElement("label",{htmlFor:"notes"},"Notes"),r.a.createElement("textarea",{placeholder:"notes",onChange:this.handleChange,name:"notes",id:"notes",value:this.state.activitie.notes}),r.a.createElement("label",{htmlFor:"price",id:"price"},"Price"),r.a.createElement("input",(e={className:"styled-input",type:"number",placeholder:"price",name:"price",id:"price",onChange:this.handleChange},Object(q.a)(e,"placeholder","price"),Object(q.a)(e,"value",this.state.activitie.price),e)),r.a.createElement("button",{className:"styled-button",onClick:this.onSaveAct},"Save"))}}]),a}(n.Component),xt=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={activitie:{name:"",at:"",time:"",labels:"",duration:"",notes:"",price:"",currency:"",destination:"",id:null},minTime:"",maxTime:"",isInputOpen:!1},e.handleTime=function(t){var a=6e4*t.getTimezoneOffset(),n=new Date(t-a).toISOString().slice(0,-1);e.setState({activitie:Object(z.a)(Object(z.a)({},e.state.activitie),{},{at:n})})},e.handleChange=function(t){var a=t.target.name,n=t.target.value;if("at"===a){var r=n.substring(n.length-5),i=+r.split(":")[0],s=+r.split(":")[1];if(s<=15?s=0:s>=45?(s=0,i+=1):s=30,i>=0&&i<7)return void e.props.showMsg({type:"input",msg:"Please choose events between 7:00 AM and 11:30 PM"});s=1===(s+"").length?"0"+s:s+"",i=1===(i+"").length?"0"+i:i+"",n=n.substring(0,n.length-5)+"".concat(i,":").concat(s),e.setState({activitie:Object(z.a)(Object(z.a)({},e.state.activitie),{},Object(q.a)({},a,n))})}else"duration"===a?e.setState({activitie:Object(z.a)(Object(z.a)({},e.state.activitie),{},Object(q.a)({},a,+n))}):e.setState({activitie:Object(z.a)(Object(z.a)({},e.state.activitie),{},Object(q.a)({},a,n))})},e.handleContentEditable=function(t){var a=t.currentTarget.dataset.name,n=t.target.innerText;"price"===a?e.setState({activitie:Object(z.a)(Object(z.a)({},e.state.activitie),{},Object(q.a)({},a,+n))}):e.setState({activitie:Object(z.a)(Object(z.a)({},e.state.activitie),{},Object(q.a)({},a,n))})},e.onSaveAct=function(t){t.preventDefault();var a=e.props.props,n=a.saveAct,r=a.isOccTimeSlot,i=e.state.activitie,s=new Date(i.at);i.at=s.getTime(),r(i)?e.props.showMsg({type:"input",msg:"You aleardy have plans for that date! please choose a different one."}):(i.price={amount:i.price,currency:"$"},n(e.state.activitie))},e.getValidTime=function(){return new Date(e.state.activitie.at)},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(g.a)(v.a.mark((function e(){var t,a,n,r,i,s;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props.props,a=t.act,n=t.destinations,s=n.findIndex((function(e){return e.name===a.destination})),r=G.getIsoTime(n[s].startDate),i=G.getIsoTime(n[s].endDate),this.setState({activitie:Object(z.a)(Object(z.a)({},a),{},{name:a.name,currency:a.price.currency,price:a.price.amount,at:G.getIsoTime(a.at),destination:a.destination}),minTime:r,maxTime:i});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=t.activitie,n=t.minTime,i=t.maxTime;if(!a)return r.a.createElement("div",null,"Loading");this.props.props.destinations;var s=G.getTimeDayStr(new Date(this.state.activitie.at).getTime()),o=G.getTimeDayStr(new Date(this.state.activitie.at).getTime()+this.state.activitie.duration/2*60*60*1e3),c=new Date(n),l=new Date(i),u=new Date(a.at),p=u.setHours(7,0),d=u.setHours(23,59),m=new Date(p),h=new Date(d);return r.a.createElement("form",{className:"preview-activity-form flex column"},r.a.createElement("h2",{contentEditable:!0,suppressContentEditableWarning:!0,autoCorrect:"off","data-name":"name",onInput:this.handleContentEditable},this.state.activitie.name),r.a.createElement("div",{className:"flex"},r.a.createElement("small",null,r.a.createElement("i",{className:"fas fa-map-marker"})," ",this.state.activitie.destination),r.a.createElement("small",null,r.a.createElement("i",{className:"far fa-clock"}),"".concat(s,"-").concat(o)," ",r.a.createElement("i",{onClick:function(){e.setState({isInputOpen:!e.state.isInputOpen})},className:"fas fa-edit"}))),r.a.createElement(ie,null),r.a.createElement("div",{className:"flex time-container ".concat(this.state.isInputOpen?"openHeight":""," ")},r.a.createElement("div",{className:"flex column"},r.a.createElement("h4",null,"Beginning time:"),r.a.createElement("input",Object(q.a)({className:"styled-input date",type:"datetime-local",id:"start-time-activity-input",min:n,max:i,name:"at",onChange:this.handleChange,value:this.state.activitie.at,required:"required"},"id","date-activity-input"))),r.a.createElement("div",{className:"flex column"},r.a.createElement("h4",null,"Duration (Half hours)"),r.a.createElement("input",{className:"styled-input",placeholder:"duration",id:"duration",type:"number",name:"duration",value:this.state.activitie.duration,onChange:this.handleChange}))),r.a.createElement("img",{src:this.props.props.act.imgUrl,alt:"https://teddytennis.com/cyprus/wp-content/uploads/sites/76/2017/11/placeholder.png"}),r.a.createElement(ee.a,{minDate:c,maxDate:l,selected:this.getValidTime().getTime(),minTime:m,maxTime:h,autoComplete:"off",className:"styled-input prev-date-picker",showTimeSelect:!0,required:!0,dateFormat:"Pp",onChange:function(t){return e.handleTime(t)}}),r.a.createElement("h4",{htmlFor:"notes"},"Notes"),r.a.createElement("textarea",{placeholder:"notes",onChange:this.handleChange,name:"notes",id:"notes",value:this.state.activitie.notes}),r.a.createElement("div",{className:"flex"},r.a.createElement("h4",null,"Price:"),r.a.createElement("p",null,this.state.activitie.currency),r.a.createElement("p",{contentEditable:!0,suppressContentEditableWarning:!0,"data-name":"price",onBlur:this.handleContentEditable},this.state.activitie.price)),r.a.createElement("button",{className:"styled-button",onClick:this.onSaveAct},"Save"))}}]),a}(n.Component),Tt=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i))).state={reviewToAdd:{content:"",name:"",rating:null}},e.elInput=r.a.createRef(),e.onInputChange=function(t,a){e.setState({reviewToAdd:Object(z.a)(Object(z.a)({},e.state.reviewToAdd),{},Object(q.a)({},a,t))})},e.onAddReview=function(t){t.preventDefault(),e.props.addReview(e.state.reviewToAdd),e.setState({reviewToAdd:{content:"",name:"",rating:null}})},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.elInput.current.focus()}},{key:"render",value:function(){var e=this,t=this.props.isReviewOpen?"open":"";return r.a.createElement("div",{className:"review-modal flex ".concat(t)},r.a.createElement("form",{className:"flex column ",onSubmit:this.onAddReview},r.a.createElement("div",{className:"flex"},r.a.createElement("input",{className:"styled-input",placeholder:"Enter your name",type:"text",name:"name",required:!0,onChange:function(t){e.onInputChange(t.target.value,t.target.name)}}),r.a.createElement("select",{name:"rating",defaultValue:"-1",required:!0,onChange:function(t){e.onInputChange(t.target.value,t.target.name)}},r.a.createElement("option",{disabled:!0,value:"-1"},"Rate the trip"),r.a.createElement("option",{value:"1"},"1"),r.a.createElement("option",{value:"2"},"2"),r.a.createElement("option",{value:"3"},"3"),r.a.createElement("option",{value:"4"},"4"),r.a.createElement("option",{value:"5"},"5"))),r.a.createElement("textarea",{id:"content",required:!0,name:"content",placeholder:"Enter your review here",ref:this.elInput,onChange:function(t){e.onInputChange(t.target.value,t.target.name)}}),r.a.createElement("button",null,"Save")))}}]),a}(r.a.Component),Nt=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={text:e.props.text,isLongTxtShown:!1},e.onReadMore=function(){e.setState({isLongTxtShown:!e.state.isLongTxtShown})},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.state.text,t=this.state.isLongTxtShown;return r.a.createElement("p",null,e.length<100||t&&e.length>100?e:e.substring(0,100)+" . . .",e.length>100&&r.a.createElement("button",{className:" styled-button expend-description",onClick:this.onReadMore},this.state.isLongTxtShown?"Less":"More"))}}]),a}(r.a.Component);function St(e){var t=e.review;var a="".concat(new Date(t.createdAt).getDate(),"/").concat(new Date(t.createdAt).getMonth()+1,"/").concat(new Date(t.createdAt).getFullYear());return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"review-details flex justify-between "},r.a.createElement("h3",null,t.name||"Traveler"),r.a.createElement("div",{className:"flex column"},r.a.createElement("div",null,function(){for(var e=[],a=0;a<t.rating;a++)e.push(r.a.createElement("img",{className:"rating-star",key:G.makeId(),src:"https://res.cloudinary.com/idanrozen/image/upload/v1600689776/450716_preview_uyyiz1.png",alt:""}));for(var n=0;n<5-t.rating;n++)e.push(r.a.createElement("img",{className:"rating-star",key:G.makeId(),src:"https://res.cloudinary.com/idanrozen/image/upload/v1600690459/450716_preview1_pvoieq.png",alt:""}));return e}()," "),r.a.createElement("p",null,a))),t.content&&r.a.createElement(Nt,{text:t.content}))}function Mt(e){var t=e.reviews;return r.a.createElement("ul",{className:"review-list flex column container"},t&&t.length?t.map((function(e,t){return r.a.createElement("li",{className:"review flex column",key:t},r.a.createElement(St,{key:e._id,review:e}))})):"No reviews have been written for this trip yet")}var Ct=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={isReviewOpen:!1},e.onToggleExpend=function(){e.setState({isReviewOpen:!e.state.isReviewOpen})},e.addReview=function(){var t=Object(g.a)(v.a.mark((function t(a){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.trip=e.props.trip._id,t.next=3,ke.addReview(a);case 3:return t.next=5,e.props.loadReviews({tripId:e.props.trip._id});case 5:e.onToggleExpend();case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(g.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.trip,e.prev=1,e.next=4,this.props.loadReviews({tripId:t._id});case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.props.trip?r.a.createElement("div",{className:"reviews-page"},r.a.createElement(Mt,{reviews:this.props.reviews}),r.a.createElement("div",{className:"flex reviews-btns-container"},r.a.createElement("button",{className:"review-btns styled-button",onClick:this.onToggleExpend},this.state.isReviewOpen?"Close":" Add Review")),r.a.createElement(Tt,{addReview:this.addReview,isReviewOpen:this.state.isReviewOpen})):r.a.createElement("p",null," Loading . . .")}}]),a}(n.Component),It={addReview:ke.addReview,loadReviews:ke.loadReviews},At=Object(d.b)((function(e){return{reviews:e.reviewReducer.reviews,trip:e.tripReducer.currTrip}}),It)(Object(o.o)(Ct)),Rt=a(149),_t=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={value:"",copied:!1},e.handleInput=function(t,a){e.setState({emailToSend:Object(z.a)(Object(z.a)({},e.state.emailToSend),{},Object(q.a)({},a,t))})},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.setState({value:"http://localhost:3000/#/trip/".concat(this.props.props,"/triproute/true")})}},{key:"onAddMember",value:function(e,t){e.preventDefault(),this.props.closeModal()}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"flex column share-trip"},r.a.createElement("h3",null,"Share this link with your trip partners and start planning together!"),r.a.createElement("img",{src:"https://thumbs.dreamstime.com/b/group-young-people-friends-celebrating-successful-hiking-expedition-group-young-people-friends-celebrating-successful-hiking-123552345.jpg",alt:""}),r.a.createElement("input",{disabled:!0,className:"styled-input",value:this.state.value,onChange:function(t){var a=t.target.value;return e.setState({value:a,copied:!1})}}),r.a.createElement(Rt.CopyToClipboard,{text:this.state.value,onCopy:function(){return e.setState({copied:!0})}},r.a.createElement("button",{className:"styled-button"},"Copy and share")),this.state.copied?r.a.createElement("span",{style:{color:"orange"}},"Copied!"):null)}}]),a}(n.Component),Lt=document.createElement("div");document.body.appendChild(Lt);var Ht=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={isShown:!1,msg:"",type:""},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("p",null,"Are you sure you want to delete?"),r.a.createElement("div",{className:"flex notification-btns"},r.a.createElement("button",{className:"styled-button",onClick:function(){return e.props.props.removeAct(e.props.props.actId)}},"Delete"),r.a.createElement("button",{className:"styled-button",onClick:function(){return e.props.closeModal()}},"Cancel")))}}]),a}(n.Component),Bt=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={dynamicCmp:"",nameToDisplay:""},e.handleClick=function(t){e.props.showModal(t)},e.checkKey=function(t){"Escape"===t.key&&e.closeModal()},e.closeModal=function(){e.props.closeModal()},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(e,t){var a=this.props.modal.cmp;if(e.modal.cmp!==a){var n="",i="";switch(a){case"login":n=r.a.createElement(Ve,{page:!0,handleClick:this.handleClick}),i="Please Login";break;case"signup":var s=this.props.modal.props;n=r.a.createElement(Ve,{page:!1,handleClick:this.handleClick,tripId:s}),i="Please Sign Up";break;case"editActivity":n=r.a.createElement(kt,{props:this.props.modal.props}),i="Edit activity";break;case"activityDetails":n=r.a.createElement(xt,{props:this.props.modal.props,showMsg:this.props.showMsg,closeMsg:this.props.closeMsg}),i="Activity Details";break;case"removeActivity":n=r.a.createElement(Ht,{props:this.props.modal.props,closeModal:this.props.closeModal}),i="Delete Activity";break;case"add-review":n=r.a.createElement(Tt,{props:this.props.modal.props.addReview,showMsg:this.props.showMsg,closeMsg:this.props.closeMsg,closeModal:this.closeModal}),i="Add Review";break;case"add-member":n=r.a.createElement(_t,{props:this.props.modal.props,closeModal:this.closeModal}),i="Add Member";break;case"trip-reviews":n=r.a.createElement(At,{closeModal:this.closeModal}),i="Reviews";break;default:n=r.a.createElement("div",null,"proplem loading modal")}this.setState({dynamicCmp:n,nameToDisplay:i})}}},{key:"render",value:function(){"login"===this.state.curCmp||this.state.curCmp;return r.a.createElement("div",{className:"modal-screen flex align-center justify-center ".concat(this.props.modal.isShown?"":"hide"),onKeyDown:this.checkKey,onMouseDown:this.closeModal},r.a.createElement("div",{className:"modal-container ",onMouseDown:function(e){return e.stopPropagation()}},r.a.createElement("div",{className:"modal-header flex align-center justify-center styled-header"},r.a.createElement("p",null,this.state.nameToDisplay),r.a.createElement("button",{onClick:this.closeModal},"X")),r.a.createElement("div",{className:"modal-content"},this.state.dynamicCmp)))}}]),a}(r.a.Component),Ut={closeModal:L,showModal:_,showMsg:te,closeMsg:ae},Wt=Object(d.b)((function(e){return{modal:e.modalReducer,msg:e.msgReducer.msg}}),Ut)(Object(o.o)(Bt)),Pt=(a(298),function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={trip:"",isReviewOpen:!1},e.onToggleExpend=function(){e.setState({isReviewOpen:!0})},e.addReview=function(){var t=Object(g.a)(v.a.mark((function t(a){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.aboutTrip=e.props.trip._id,t.next=3,ke.addReview(a);case 3:return t.next=5,e.props.loadReviews({tripId:e.props.trip._id});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(g.a)(v.a.mark((function e(){var t;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params.id,e.prev=1,e.next=4,this.props.loadTrip(t);case 4:return e.next=6,this.props.loadReviews({tripId:this.props.trip._id});case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(1);case 10:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.trip;if(!t)return r.a.createElement("p",null," Loading . . .");var a=G.calculateDays(t.destinations[0].startDate,t.destinations[t.destinations.length-1].endDate);return r.a.createElement("div",{className:"trip-preview reviews-page"},r.a.createElement("div",{className:"img-wraper"},r.a.createElement("img",{src:G.getRandomPic(),alt:""})),r.a.createElement("h2",null,a," days to ",t.destinations[0].name),r.a.createElement("p",null,"By: Moshe544"),r.a.createElement("div",{className:"addreview-container"},r.a.createElement(m.Link,{to:"/trip/".concat(t._id,"/triproute")},r.a.createElement("button",{onClick:this.props.closeModal,className:"styled-button"},"Explore this trip")),r.a.createElement(Mt,{reviews:this.props.reviews}),r.a.createElement("div",{className:"flex reviews-btns-container"},r.a.createElement("button",{className:"review-btns styled-button",onClick:function(){return e.props.showModal("add-review",{addReview:e.addReview})}},"Add Review"),r.a.createElement("button",{className:"review-btns styled-button",onClick:function(){e.props.history.push("/trip")}},"Back"))))}}]),a}(n.Component)),Ft={addReview:ke.addReview,loadReviews:ke.loadReviews,loadTrip:I,showModal:_},Yt=Object(d.b)((function(e){return{reviews:e.reviewReducer.reviews,trip:e.tripReducer.currTrip}}),Ft)(Object(o.o)(Pt)),Jt=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return this.props.loader?r.a.createElement("div",{className:"positioning-container"},r.a.createElement("div",{className:"spinning-container"},r.a.createElement("span",null,"LOADING"),r.a.createElement("div",{className:"airplane-container"},r.a.createElement("img",{className:"plane",src:"https://res.cloudinary.com/roidinary/image/upload/v1600624566/Asset_dwekpj.png",alt:"Loading"})))):r.a.createElement(r.a.Fragment,null)}}]),a}(r.a.Component),Qt=Object(d.b)((function(e){return{loader:e.modalReducer.loaderOn}}),{})(Jt);function qt(){return r.a.createElement("div",{className:"footer flex align-center justify-center"},"TrollyRights 2022")}function zt(){return r.a.createElement("div",{style:{position:"relative"},className:"App "},r.a.createElement(J,null),r.a.createElement("main",null,r.a.createElement(Wt,null),r.a.createElement(Qt,null),r.a.createElement(o.g,null,r.a.createElement(o.d,{component:Ve,path:"/lognsignup"}),r.a.createElement(o.d,{component:Ot,path:"/trip/:id/:triproute/:openSignup?"}),r.a.createElement(o.d,{component:Yt,path:"/trip/:id/"}),r.a.createElement(o.d,{component:jt,path:"/user/:id"}),r.a.createElement(o.d,{component:Fe,path:"/trip"}),r.a.createElement(o.d,{component:Q,path:"/about"}),r.a.createElement(o.d,{exact:!0,component:Be,path:"/"}))),r.a.createElement(qt,null))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Vt=a(41),Gt=a(150),Kt={isShown:!1,props:null,cmp:null,msg:null,loaderOn:!1};var Xt={isShown:!1,type:"",msg:""};var $t={reviews:[],selectedReview:null};var Zt={trips:[],currTrip:null};var ea=null;sessionStorage.user&&(ea=JSON.parse(sessionStorage.user));var ta={users:[],loggedInUser:ea};var aa=Object(Vt.c)({tripReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TRIPS":return Object(z.a)(Object(z.a)({},e),{},{trips:t.trips});case"EDIT_TRIP":return Object(z.a)(Object(z.a)({},e),{},{currTrip:Object(z.a)({},t.trip),trips:e.trips.map((function(e){return t.trip._id===e._id?t.trip:e}))});case"SET_TRIP":return console.log("tripReducer -> action.trip",t.trip),console.log("tripReducer -> state",e),Object(z.a)(Object(z.a)({},e),{},{currTrip:Object(z.a)({},t.trip)});default:return e}},userReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ta,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return{users:Object(V.a)(e.users),loggedInUser:t.user};case"SET_USERS":return Object(z.a)(Object(z.a)({},e),{},{users:t.users});default:return e}},modalReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MODAL":return{isShown:!0,props:t.props,cmp:t.cmp};case"CLOSE_MODAL":return{isShown:!1,props:null,cmp:null};case"LOGIN_PROBLEML":return Object(z.a)(Object(z.a)({},e),{},{msg:"wrong email or password"});case"SET_LOADER":return{loaderOn:!0};case"CLOSE_LOADER":return{loaderOn:!1};default:return e}},reviewReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$t,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case"SET_REVIEWS":return Object(z.a)(Object(z.a)({},e),{},{reviews:t.reviews});case"REVIEW_ADD":return Object(z.a)(Object(z.a)({},e),{},{reviews:[].concat(Object(V.a)(e.reviews),[t.review])});case"REVIEW_UPDATE":return Object(z.a)(Object(z.a)({},e),{},{reviews:e.reviews.map((function(e){return e._id===t.review._id?t.review:e}))});default:return e}},msgReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MSG":return{isShown:!0,msg:t.msg.msg,type:t.msg.type};case"CLOSE_MSG":return{isShown:!1,type:"",msg:""};default:return e}}}),na=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Vt.d,ra=Object(Vt.e)(aa,na(Object(Vt.a)(Gt.a))),ia=a(314),sa=a(151);s.a.render(r.a.createElement(d.a,{store:ra},r.a.createElement(ia.a,{backend:sa.a},r.a.createElement(m.HashRouter,null,r.a.createElement(zt,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[153,1,2]]]);
//# sourceMappingURL=main.7c522c72.chunk.js.map